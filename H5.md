# H5 Loppuhuipennus

Tässä tehtävässä tarkoitus oli jatkaa viime viikolla aloitettu projekti loppuun. 

Viimeisenä vaiheena käsin tehtynä masterilla otin vielä käyttöön automaattiset päivitykset komennolla `sudo dpkg-reconfigure unattended-upgrades`. 

![Screenshot](https://github.com/user-attachments/assets/91ea8fa8-553d-4980-94db-50442ed94902)

Seuraavaksi lähdin määrittelemään salt-tiloja. Loin aluksi /srv/salt -kansioon uuden kansion updates. Kopioin tänne /etc/apt/apt.conf.d -kansiosta tiedostot 20auto-upgrades
ja 50unattended-upgrades. Lisäksi loin vielä init.sls -tiedoston. Ongelmaksi muodostui se, kun yritin ottaa päivitykset käyttöön komennolla `sudo dpkg-reconfigure unattended-upgrades`. Tämä komento vaatii käyttäjän syötettä (yes), jotta komento voi jatkua. Init.sls -tiedoston ajo jäi rullaamaan ikuisesti, joten oletin, että vika on tuossa kohdassa. Kokeilin ajaa tiedoston ilman kyseistä kohtaa ja ajo suoritettiin onnistuneesti. 

Init.sls -tiedostossa aluksi varmistetaan, että unattended-upgrades on asennettu. Tämän jälkeen kopioidaan masterilta minionille kaksi tiedostoa kansioon /etc/apt/apt.conf.d. Tämän jälkeen yritetään ottaa käyttöön automaattiset päivitykset komennolla `sudo dpkg-reconfigure unattended-upgrades`. Jotta komento voidaan suorittaa täytyy unattended-upgrades olla asennettuna. Lopuksi vielä käynnistetään demoni uudelleen.

# Lähteet:

https://terokarvinen.com/palvelinten-hallinta/

https://wiki.debian.org/UnattendedUpgrades

https://help.ubuntu.com/community/AutomaticSecurityUpdates

https://docs.saltproject.io/en/latest/ref/states/all/salt.states.file.html

https://docs.saltproject.io/en/latest/ref/states/all/salt.states.service.html

https://docs.saltproject.io/en/latest/ref/states/all/salt.states.cmd.html


